# üöÄ AWS DMS Migration Orchestrator

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![License](https://img.shields.io/github/license/JFCandia/aws-dms-migration-orchestrator)
![GitHub Stars](https://img.shields.io/github/stars/JFCandia/aws-dms-migration-orchestrator?style=social)
![GitHub Forks](https://img.shields.io/github/forks/JFCandia/aws-dms-migration-orchestrator?style=social)
![AWS](https://img.shields.io/badge/AWS-DMS%20%7C%20Lambda%20%7C%20SNS-orange.svg)
![Node.js](https://img.shields.io/badge/Node.js-18%2B-green.svg)
![Build Status](https://img.shields.io/github/actions/workflow/status/JFCandia/aws-dms-migration-orchestrator/ci-cd.yml?branch=main)

**üéØ Sistema de orquestaci√≥n profesional para AWS Database Migration Service (DMS)**

Soluci√≥n serverless completa que automatiza, monitorea y gestiona migraciones de bases de datos en AWS DMS con arquitectura de microservicios, manejo robusto de errores y observabilidad avanzada.

> üíº **Proyecto de Portfolio**: Demuestra competencias avanzadas en AWS, Serverless Architecture, DevOps y Node.js

## üìã Tabla de Contenidos

- [Caracter√≠sticas](#-caracter√≠sticas)
- [Arquitectura](#-arquitectura)
- [Instalaci√≥n R√°pida](#-instalaci√≥n-r√°pida)
- [Configuraci√≥n](#-configuraci√≥n)
- [Uso](#-uso)
- [Despliegue](#-despliegue)
- [Monitoreo](#-monitoreo)
- [Testing](#-testing)
- [API Reference](#-api-reference)
- [Troubleshooting](#-troubleshooting)
- [Contribuir](#-contribuir)

## ‚ú® Caracter√≠sticas

### üéØ Funcionalidades Principales
- **Validaci√≥n Previa**: Verificaci√≥n completa de configuraci√≥n antes de migrar
- **Migraci√≥n Autom√°tica**: Inicio y gesti√≥n de tareas DMS
- **Monitoreo en Tiempo Real**: Seguimiento continuo del progreso
- **Orquestaci√≥n Avanzada**: Pipeline completo con manejo de errores
- **Notificaciones Inteligentes**: Alertas por email/SNS
- **Step Functions**: Workflows visuales para procesos complejos

### üõ†Ô∏è Tecnolog√≠as
- **AWS Services**: DMS, Lambda, Step Functions, SNS, DynamoDB, CloudWatch
- **Runtime**: Node.js 18+
- **IaC**: AWS SAM, Serverless Framework, Terraform
- **Monitoring**: CloudWatch Metrics, Custom Dashboards
- **Testing**: Jest, Simulaci√≥n completa

### üèóÔ∏è Modos de Operaci√≥n
- **Script Standalone**: Ejecuci√≥n directa con `node iniciar-migracion.js`
- **Lambda Functions**: Funciones individuales para cada proceso
- **Step Functions**: Workflow orquestado con estado visual
- **API Gateway**: Endpoints REST para integraci√≥n
- **Scheduled**: Ejecuci√≥n programada con EventBridge

## üèõÔ∏è Arquitectura

```mermaid
graph TD
    A[Trigger] --> B{Orchestrator}
    B --> C[Validate Function]
    B --> D[Migrate Function] 
    B --> E[Monitor Function]
    
    C --> F[DMS Tasks Check]
    C --> G[Endpoints Check]
    C --> H[IAM Permissions]
    
    D --> I[Start DMS Tasks]
    D --> J[Task Status Check]
    
    E --> K[Progress Monitoring]
    E --> L[Performance Analysis]
    E --> M[Alert Generation]
    
    F --> N[SNS Notifications]
    G --> N
    H --> N
    I --> N
    J --> N
    K --> N
    L --> N
    M --> N
    
    E --> O[DynamoDB Logs]
    E --> P[CloudWatch Metrics]
    
    style B fill:#f9f,stroke:#333,stroke-width:4px
    style N fill:#9f9,stroke:#333,stroke-width:2px
    style O fill:#bbf,stroke:#333,stroke-width:2px
    style P fill:#bbf,stroke:#333,stroke-width:2px
```

### üì¶ Componentes

| Componente | Funci√≥n | Timeout | Memoria |
|------------|---------|---------|---------|
| **Orchestrator** | Coordina el pipeline completo | 15 min | 512 MB |
| **Validate** | Valida configuraci√≥n DMS | 5 min | 512 MB |
| **Migrate** | Inicia tareas de migraci√≥n | 10 min | 512 MB |
| **Monitor** | Monitorea progreso y rendimiento | 5 min | 512 MB |

## üöÄ Instalaci√≥n R√°pida

### Prerrequisitos
```bash
# AWS CLI configurado
aws --version

# Node.js 18+
node --version

# SAM CLI (opcional)
sam --version

# Serverless Framework (opcional)
serverless --version
```

### Instalaci√≥n
```bash
# Clonar repositorio
git clone https://github.com/tu-usuario/migrador-dms.git
cd migrador-dms

# Instalar dependencias
npm install

# Configurar variables de entorno
cp .env.example .env
# Editar .env con tus valores AWS reales

# Ejecutar en modo simulaci√≥n (sin AWS)
npm start
```

## ‚öôÔ∏è Configuraci√≥n

### Variables de Entorno Principales

```bash
# AWS Configuration
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key

# DMS Task ARN
DMS_TASK_ARN=arn:aws:dms:us-east-1:123456789012:task:your-task

# Notification Email
NOTIFICATION_EMAIL=admin@yourcompany.com

# Modo de Operaci√≥n
TESTING_MODE=true          # true para testing
SIMULATE_MODE=true         # true para simulaci√≥n sin AWS
USE_ORCHESTRATOR=true      # true para usar orquestador
```

### Configuraci√≥n Avanzada

**thresholds.json**
```json
{
  "maxErroredTables": 0,
  "minProgressPercent": 10,
  "slowProgressTimeMs": 1800000,
  "maxExecutionTimeMs": 14400000
}
```

## üìñ Uso

### 1. Ejecuci√≥n B√°sica (Script Standalone)

```bash
# Modo simulaci√≥n (sin AWS)
npm start

# Modo testing con validaci√≥n AWS
SIMULATE_MODE=false npm start

# Modo producci√≥n
TESTING_MODE=false SIMULATE_MODE=false npm start
```

### 2. Funciones Lambda Individuales

```bash
# Validar configuraci√≥n
npm run invoke:validate

# Iniciar migraci√≥n
npm run invoke:migrate

# Monitorear progreso
npm run invoke:monitor

# Ejecutar orquestador
npm run invoke:orchestrator
```

### 3. API REST (despu√©s del deploy)

```bash
# Iniciar migraci√≥n via API
curl -X POST https://your-api-gateway-url/migrate \
  -H "Content-Type: application/json" \
  -H "x-api-key: your-api-key" \
  -d '{
    "taskArns": ["arn:aws:dms:..."],
    "restartFailedTasks": true
  }'
```

### 4. Programaci√≥n con EventBridge

```bash
# La funci√≥n se ejecuta autom√°ticamente seg√∫n el schedule configurado
# Por defecto: diariamente a las 2 AM (cron(0 2 * * ? *))
```

## üöÄ Despliegue

### Opci√≥n 1: AWS SAM (Recomendado)

```bash
# Build y deploy interactivo
sam build && sam deploy --guided

# Deploy autom√°tico
sam deploy --stack-name migrador-dms-prod \
  --parameter-overrides Environment=prod NotificationEmail=prod@company.com
```

### Opci√≥n 2: Serverless Framework

```bash
# Deploy desarrollo
npm run deploy:dev

# Deploy producci√≥n
npm run deploy:prod
```

### Opci√≥n 3: Terraform

```bash
# Crear infraestructura
terraform init
terraform plan -var="notification_email=admin@company.com"
terraform apply
```

### Opci√≥n 4: Manual CLI

Ver [DESPLIEGUE-ALTERNATIVO.md](DESPLIEGUE-ALTERNATIVO.md) para instrucciones detalladas.

## üìä Monitoreo

### CloudWatch Dashboards

El sistema crea autom√°ticamente dashboards con:
- **M√©tricas de Lambda**: Duraci√≥n, errores, invocaciones
- **M√©tricas DMS**: Progreso, throughput, errores
- **Alertas**: Configurables por threshold
- **Logs**: Centralizados y estructurados

### M√©tricas Personalizadas

```javascript
// M√©tricas enviadas a CloudWatch
- DMS/Migration/TasksMonitored
- DMS/Migration/AverageProgress  
- DMS/Migration/TotalAlerts
- DMS/Migration/PerformanceScore
- DMS/Migration/TasksByStatus
```

### Alertas y Notificaciones

- **Email**: Via SNS para eventos cr√≠ticos
- **Slack**: Webhook configurable
- **PagerDuty**: Para alertas 24/7
- **CloudWatch Alarms**: Autom√°ticas por threshold

## üß™ Testing

### Tests de Simulaci√≥n

```bash
# Test completo de simulaci√≥n
npm run test:simulation

# Test del orquestador
npm run test:orchestrator

# Tests unitarios
npm run test:unit

# Tests de integraci√≥n
npm run test:integration
```

### Tests Locales

```bash
# API local con SAM
npm run local:api

# Lambda local
npm run local:lambda

# Serverless offline
npm run local:serverless
```

### Coverage

```bash
# Generar reporte de coverage
npm test
# Ver reporte en coverage/lcov-report/index.html
```

## üìö API Reference

### Orchestrator Function

#### POST /migrate

Inicia el proceso completo de migraci√≥n.

**Request:**
```json
{
  "taskArns": ["arn:aws:dms:..."],
  "useStepFunctions": false,
  "restartFailedTasks": true,
  "waitForCompletion": true,
  "maxWaitTimeSeconds": 3600
}
```

**Response:**
```json
{
  "success": true,
  "executionId": "orch-12345...",
  "executionMode": "lambda",
  "stepsExecuted": 3,
  "duration": 45000
}
```

### Validate Function

#### POST /validate

Valida la configuraci√≥n DMS antes de migrar.

**Request:**
```json
{
  "taskArn": "arn:aws:dms:...",
  "thresholds": {
    "maxErroredTables": 0
  }
}
```

**Response:**
```json
{
  "isValid": true,
  "checks": {
    "awsCredentials": {"valid": true},
    "dmsConnectivity": {"valid": true},
    "dmsTasks": {"valid": true, "count": 5}
  },
  "errors": [],
  "warnings": []
}
```

## üîß Troubleshooting

### Errores Comunes

#### "Task not found"
```bash
# Verificar ARN de la tarea
aws dms describe-replication-tasks \
  --filters Name=replication-task-arn,Values=your-task-arn
```

#### "Invalid credentials"
```bash
# Verificar credenciales
aws sts get-caller-identity

# Configurar credenciales
aws configure
```

#### "Function timeout"
```bash
# Aumentar timeout en template.yaml o serverless.yml
Timeout: 900  # 15 minutos
```

### Logs y Debugging

```bash
# Ver logs en tiempo real
npm run logs:orchestrator

# Logs espec√≠ficos de CloudWatch
aws logs tail /aws/lambda/migrador-dms-orchestrator --follow

# Debug local
DEBUG=true npm start
```

### Performance Issues

1. **Migraci√≥n lenta**: Aumentar recursos DMS, revisar configuraci√≥n de red
2. **Lambda timeout**: Aumentar timeout, optimizar c√≥digo
3. **Memory issues**: Aumentar memoria de Lambda
4. **API throttling**: Implementar exponential backoff

## üìà Roadmap

### Versi√≥n 1.1
- [ ] Soporte para m√∫ltiples regiones AWS
- [ ] Dashboard web personalizado
- [ ] Integraci√≥n con Datadog/New Relic
- [ ] Backup autom√°tico pre-migraci√≥n

### Versi√≥n 1.2
- [ ] Migraci√≥n batch de m√∫ltiples bases
- [ ] ML para predicci√≥n de tiempos
- [ ] API GraphQL
- [ ] Mobile app para monitoreo

## ü§ù Contribuir

### Desarrollo Local

```bash
# Fork del repositorio
git clone https://github.com/tu-usuario/migrador-dms.git
cd migrador-dms

# Crear rama feature
git checkout -b feature/nueva-funcionalidad

# Instalar dependencias
npm install

# Ejecutar tests
npm test

# Crear PR
```

### Guidelines

- **Code Style**: ESLint standard
- **Tests**: Jest con >80% coverage
- **Commits**: Conventional commits
- **Documentation**: JSDoc para funciones

### Issues y Support

- üêõ [Reportar Bug](https://github.com/tu-usuario/migrador-dms/issues)
- üí° [Feature Request](https://github.com/tu-usuario/migrador-dms/issues)
- ‚ùì [Preguntas](https://github.com/tu-usuario/migrador-dms/discussions)

## üìÑ Licencia

MIT License - ver [LICENSE](LICENSE) para detalles.

## ÔøΩ‚Äçüíª Sobre el Desarrollador

Este proyecto fue desarrollado como demostraci√≥n de habilidades en:

### üéØ **Competencias T√©cnicas Demostradas**
- **Cloud Architecture**: Dise√±o de soluciones serverless escalables
- **AWS Expertise**: Lambda, DMS, Step Functions, SNS, DynamoDB, CloudWatch
- **DevOps**: Infrastructure as Code (SAM, Serverless, Terraform)
- **Node.js Development**: Aplicaciones robustas con manejo de errores
- **Testing**: Unit testing, integration testing, mocking
- **Documentation**: Documentaci√≥n t√©cnica completa y clara
- **CI/CD**: Preparado para pipelines automatizados

### üèÜ **Logros del Proyecto**
- ‚úÖ **Arquitectura Serverless Completa**: 4 funciones Lambda orquestadas
- ‚úÖ **Alta Disponibilidad**: Manejo robusto de errores y retry autom√°tico  
- ‚úÖ **Observabilidad**: M√©tricas, logs y alertas personalizadas
- ‚úÖ **M√∫ltiples Deployment Options**: SAM, Serverless, Terraform
- ‚úÖ **Testing Comprehensive**: >80% code coverage con simulaci√≥n
- ‚úÖ **Production Ready**: Configuraci√≥n para m√∫ltiples ambientes

### üõ†Ô∏è **Metodolog√≠as Aplicadas**
- **Clean Code**: C√≥digo limpio y bien documentado
- **SOLID Principles**: Arquitectura modular y mantenible
- **Error Handling**: Manejo exhaustivo de edge cases
- **Monitoring**: Instrumentaci√≥n completa para observabilidad
- **Security**: IAM roles con least privilege principle
- **Scalability**: Dise√±o para manejar m√∫ltiples migraciones concurrentes

---

## üìû Contacto

- **Desarrollador**: Juan Francisco Candia
- **Email**: candia1978@gmail.com
**GitHub**:https://github.com/JFCandia/aws-dms-migration-orchestrator/

---

‚≠ê **¬°Dale una estrella si este proyecto demuestra las habilidades que buscas!** ‚≠ê

---

## üìä Project Stats

![GitHub repo size](https://img.shields.io/github/repo-size/JFCandia/aws-dms-migration-orchestrator)
![GitHub code size](https://img.shields.io/github/languages/code-size/JFCandia/aws-dms-migration-orchestrator)
![GitHub language count](https://img.shields.io/github/languages/count/JFCandia/aws-dms-migration-orchestrator)
![GitHub top language](https://img.shields.io/github/languages/top/JFCandia/aws-dms-migration-orchestrator)

## üîó Enlaces √ötiles

- **[üåê Repositorio GitHub](https://github.com/JFCandia/aws-dms-migration-orchestrator)**
- **[üìã Issues & Features](https://github.com/JFCandia/aws-dms-migration-orchestrator/issues)**
- **[üöÄ Releases](https://github.com/JFCandia/aws-dms-migration-orchestrator/releases)**
- **[ü§ù Contribuir](https://github.com/JFCandia/aws-dms-migration-orchestrator/blob/main/CONTRIBUTING.md)**

**üöÄ Desarrollado para demostrar expertise en AWS y Arquitecturas Serverless**
